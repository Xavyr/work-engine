(function(f){var k=window.AmazonUIPageJS||window.P,l=k._namespace||k.attributeErrors,b=l?l("AudibleSamplePlayerAssets"):k;b.guardFatal?b.guardFatal(f)(b,window):b.execute(function(){f(b,window)})})(function(f,k,l){f.when("A","jQuery","SWFObject").register("AudibleAudioPlayer",function(b,c,d){function a(a,d){var b="adbl_smpl_";"Play"===d?a.logFirstPlay?(a.logFirstPlay=0,d="FirstPlay",b+="frst_play"):b+="play":"Paused"===d?b+="paus":"Ended"===d&&(b+="endd");"undefined"!==typeof a.asin?c.post("/gp/audible/sample-player/log/"+
a.asin+"?s="+d+"&ref="+b):c.post("/gp/audible/sample-player/log?s="+d+"&ref="+b)}function e(d){function b(){e.audioObj.addEventListener("ended",function(){e.audioId.trigger("audioEnded");e.isPlaying=0;a(e,"Ended")});e.audioObj.addEventListener("playing",function(){e.audioId.trigger("audioPlaying");e.isPlaying=1;a(e,"Play")});e.audioObj.addEventListener("pause",function(){e.audioId.trigger("audioPaused");e.isPlaying=0;a(e,"Paused")});e.audioObj.addEventListener("loadstart",function(){e.audioId.trigger("audioLoad");
e.isPlaying=0})}var e={initializePlayer:function(a){e.options=a;e.isFirstPlay=1;e.logFirstPlay=1;e.asin=a.asin},play:function(){if(e.isFirstPlay){var a=e.options,g=c("<audio />");g.attr("id",a.audioId);g.attr("src",a.audioSrc);c("body").append(g);e.audioObj=c("#"+a.audioId).get(0);e.audioId=c("#"+a.audioId);b();"function"===typeof d.bindEventsCallback&&d.bindEventsCallback(e.audioId);e.isFirstPlay=0;h.push(e)}e.audioObj.play()},pause:function(){e.audioObj.pause()}};return e}function g(b){var e={};
k.Mp3Interface||(k.Mp3Interface={currentPlayer:null,setCurrentPlayer:function(a){if(a){var b=k.Mp3Interface;b.currentPlayer&&b.currentPlayer.options.audioId!==a.options.audioId&&b.currentPlayer.isPlaying&&(d.getObjectById(b.currentPlayer.options.audioId).pauseSong(),b.currentPlayer.isPlaying=0);b.currentPlayer=a}},callback:function(d){var b=k.Mp3Interface;b.currentPlayer&&("onLoad"===d?(b.currentPlayer.options.audioControllerId.trigger("audioLoad"),b.currentPlayer.isPlaying=0):"onPlay"===d?(b.currentPlayer.options.audioControllerId.trigger("audioPlaying"),
b.currentPlayer.isPlaying=1,a(b.currentPlayer,"Play")):"onPause"===d?(b.currentPlayer.options.audioControllerId.trigger("audioPaused"),b.currentPlayer.isPlaying=0,a(b.currentPlayer,"Paused")):"onComplete"===d&&(b.currentPlayer.options.audioControllerId.trigger("audioEnded"),b.currentPlayer.isPlaying=0,a(b.currentPlayer,"Ended")))}});e.initializePlayer=function(a){var b=c("<div />");b.attr("id",a.audioId);c("body").append(b);var b=a.flashPlayerUrl,g=a.audioId,h=a.minFlashVersion,m={protocol:k.location.protocol.replace(":",
"")};d.embedSWF(b,g,1,1,h,null,m,{allowScriptAccess:"always"});e.isFirstPlay=1;e.isPlaying=0;e.logFirstPlay=1;e.options=a;"function"===typeof a.bindEventsCallback&&a.bindEventsCallback(e.options.audioControllerId)};e.play=function(){k.Mp3Interface.setCurrentPlayer(this);e.isPlaying||(e.isFirstPlay?(d.getObjectById(e.options.audioId).playSong(b.audioSrc),e.isFirstPlay=0):d.getObjectById(e.options.audioId).pauseSong())};e.pause=function(){e.isPlaying&&d.getObjectById(e.options.audioId).pauseSong()};
return e}var h=[];return function(){var a={init:function(b){if("undefined"!==typeof b.audioSrc&&"undefined"!==typeof b.audioId&&"undefined"!==typeof b.audioControllerId){var c=b.audioSrc,h=document.createElement("audio"),r,x,c=c.match("[^.]+$");null!==c&&0<c.length&&(r=c[0],"mp3"===r?x="audio/mpeg":"ogg"===r?x="audio/ogg":"wav"===r&&(x="audio/wav"));r=x+'; codecs="'+r+'"';x=0;h&&h.canPlayType&&h.canPlayType(r)&&h.canPlayType(r).replace(/no/,"")&&(x=1);x?(a.player=new e(b),a.player.initializePlayer(b),
a.isPlayerAvailable=1):b.flashPlayerUrl&&d&&d.hasFlashPlayerVersion("9.0.0")&&(b.minFlashVersion="9.0.0",a.player=new g(b),a.player.initializePlayer(b),a.isPlayerAvailable=1)}},pause:function(){"undefined"!==typeof a.player&&a.player.pause()},play:function(){if("undefined"!==typeof a.player){a.player.play();for(var b=a.player.options.audioId,d=0;d<h.length;d++){var c=h[d];b!==c.options.audioId&&c.pause()}}}};return a}});f.when("A","jQuery","AudibleAudioPlayer","a-popover").register("AudibleSamplePlayer",
function(b,c,d,a){function e(){if(p){var a=Math.round((b.now()-p)/1E3);p=b.now();m("adbl-smpl-played-seconds",a)}else p=b.now()}function g(){var a=h(r.duration-r.currentTime);c(".audible-sample-container .time-remaining_text").html(a);var a=1-(r.duration-r.currentTime)/r.duration,b=42*Math.PI;c(".audible-sample-container .progressCircle").attr("stroke-dashoffset",(1-a)*b);c(".audible-sample-container .activeProgressBar").attr("x2",100*a+"%")}function h(a){var b=Math.round(a%60);a=Math.floor(a/60)%
60;return"-"+(10>a?"0"+a:a)+":"+(10>b?"0"+b:b)}function m(a,b){n&&n.count&&(n.count(a,(n.count(a)||0)+(b||1)),x&&n.count(a+"-"+x,(n.count(a)||0)+(b||1)))}var q=[],n=k.ue,p=null,r=null,x=null;return{init:function(b){if(b&&b.flashPlayerUrl&&b.container){var f=c(b.container),k=b.pauseCallback,l=b.playCallback,u,w;f.each(function(){var f=c(this);if("undefined"!==typeof f){var E=f.find(".audioPlaySample"),B=f.find(".audioPlaying"),C=f.find(".audioPaused"),F=f.find(".audioLoading"),G=new d;q.push(G);var I=
{},H=f.prev();I.audioSrc=H.data("audiosource");I.audioId=H.data("audioid");I.asin=H.data("asin");x=H.data("layoutweblab");I.flashPlayerUrl=b.flashPlayerUrl;I.audioControllerId=f;I.bindEventsCallback=function(d){d.bind("audioEnded",function(){C.hide();B.hide();E.show();F.hide();b.showPopover&&a.remove(f);m("adbl-smpl-play-ended");n&&n.tag&&n.tag("FinishedAudibleSample");u&&(p=null,clearInterval(u));w&&clearInterval(w);if("T1"===x||"T2"===x){var d=h(0);c(".audible-sample-container .time-remaining_text").html(d)}});
d.bind("audioPlaying",function(){C.hide();E.hide();B.show();F.hide();if(b.showPopover){var d=b.popoverOptions;f&&d&&d.inlineContent&&(d.inlineContent=d.inlineContent.replace(/\/dp\/[a-zA-Z0-9]*\//g,"/dp/"+f.data("asin")+"/"),(d=a.create(f,d))&&d.show())}m("adbl-smpl-play");n&&n.tag&&n.tag("PlayedAudibleSample");u=setInterval(e,5E3);r=this;if("T1"===x||"T2"===x)g(),w=setInterval(g,1E3)});d.bind("audioPaused",function(){B.hide();E.hide();C.show();F.hide();b.showPopover&&a.remove(f);m("adbl-smpl-pause");
u&&(p=null,clearInterval(u));w&&clearInterval(w)});d.bind("audioLoad",function(){B.hide();E.hide();C.hide();F.show();b.showPopover&&a.remove(f);m("adbl-smpl-audio-loaded")})};G.init(I);G&&G.isPlayerAvailable&&(B.hide(),C.hide(),F.hide(),E.show(),f.removeClass("a-hidden"),f.children().click(function(){G.player.isPlaying?(G.pause(),"undefined"!==typeof k&&k()):(G.play(),"undefined"!==typeof l&&l())}))}})}},pause:function(){q.forEach(function(a){a.player.isPlaying&&a.pause()})}}})});